webpackJsonp([32],{"5Hj/":function(o,e,t){"use strict";var r={render:function(){var o=this,e=o.$createElement,t=o._self._c||e;return t("div",{staticClass:"login_wrapper"},[t("div",{staticClass:"login"},[t("el-form",{attrs:{model:o.formLogin}},[t("el-form-item",[t("h2",{staticClass:"title"},[o._v("后台管理系统")])]),o._v(" "),t("el-form-item",[t("el-input",{attrs:{placeholder:"账号"},model:{value:o.formLogin.loginName,callback:function(e){o.$set(o.formLogin,"loginName",e)},expression:"formLogin.loginName"}})],1),o._v(" "),t("el-form-item",[t("el-input",{attrs:{type:o.passw,placeholder:"密码","show-password":""},model:{value:o.formLogin.password,callback:function(e){o.$set(o.formLogin,"password",e)},expression:"formLogin.password"}})],1),o._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:o.login}},[o._v("登陆")]),o._v(" "),t("span",{directives:[{name:"show",rawName:"v-show",value:this.errorInfo.isShowError,expression:"this.errorInfo.isShowError"}],staticClass:"error"},[o._v("\n                    "+o._s(this.errorInfo.text)+"\n                ")])],1)],1)],1)])},staticRenderFns:[]};e.a=r},"9qfM":function(o,e){},I4t6:function(o,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=t("qzrg"),n=(r=i)&&r.__esModule?r:{default:r};e.default={name:"login",data:function(){return{passw:"password",formLogin:{loginName:"",password:""},checked:!0,errorInfo:{text:"登陆失败,请重试",isShowError:!1}}},mounted:function(){var o=this,e=arguments;document.onkeydown=function(t){o.$route.path;var r=t||window.event||e.callee.caller.arguments[0];r&&13==r.keyCode&&"/login"==o.$route.path&&o.login()},this.getCookie();var t={ip:returnCitySN.cip,city:returnCitySN.cname+"-进入首页"};n.default.shiroApi.loginLog(t)},methods:{login:function(){var o=this;n.default.shiroApi.loginIn(this.formLogin).then(function(e){console.log("success:",e);e.access_token;if(e&&e.data){var t=e.data;if(console.log(t),0==t.error_code){console.log("登录成功！");var r="Bearer "+t.data.access_token;localStorage.setItem("Authorization",r),1==o.checked?(console.log("checked == true"),o.setCookie(o.formLogin.loginName,o.formLogin.password,7)):(console.log("清空Cookie"),o.clearCookie()),o.$common.setSessionStorage("username",o.formLogin.loginName),o.$store.dispatch("add_Menus",t.data.sysMenuVoList),o.$store.dispatch("add_Routes",t.data.sysMenuVoList),o.$store.dispatch("add_Permissions",t.data.rolePermissionVoList),o.$router.replace({path:"/index"});var i={ip:returnCitySN.cip,city:returnCitySN.cname+"-"+t.data.userInfo.userName+"-登陆"};return void n.default.shiroApi.loginLog(i)}t.message&&(o.errorInfo.text=t.message)}o.errorInfo.isShowError=!0,o.$store.dispatch("loginLog",i)}).catch(function(o){console.log(o),console.log("error:",o)})},setCookie:function(o,e,t){var r=new Date;r.setTime(r.getTime()+864e5*t),window.document.cookie="userName="+o+";path=/;expires="+r.toGMTString(),window.document.cookie="userPwd="+e+";path=/;expires="+r.toGMTString()},getCookie:function(){if(document.cookie.length>0)for(var o=document.cookie.split("; "),e=0;e<o.length;e++){var t=o[e].split("=");"userName"==t[0]?this.formLogin.loginName=t[1]:"userPwd"==t[0]&&(this.formLogin.password=t[1])}},clearCookie:function(){this.setCookie("","",-1)},rollBackTables:function(){var o=this,e="数据还原";function t(o){var e={ip:returnCitySN.cip,city:returnCitySN.cname+"-"+o};n.default.shiroApi.loginLog(e)}n.default.shiroApi.rollBackTables().then(function(r){var i="";i="SUCCESS"==r.data.status?(e+="成功")+",请重新登陆":(e+="失败")+",请重试",o.$alert(i,"提示",{confirmButtonText:"确定"}),t(e)}).catch(function(r){o.$alert("数据还原异常,请重试","提示",{confirmButtonText:"确定"}),t(e+="失败")}),console.log(e)}}}},K31e:function(o,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=t("I4t6"),i=t.n(r);for(var n in r)"default"!==n&&function(o){t.d(e,o,function(){return r[o]})}(n);var s=t("5Hj/");var a=function(o){t("9qfM")},l=t("VU/8")(i.a,s.a,!1,a,null,null);e.default=l.exports}});